<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>DGD and LPC: State Dumps</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="../../phantasmal.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table width="95%" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <td colspan="2"> <table width="100%" border="0" cellspacing="1"
        cellpadding="0" class="main">
        <tr>
          <td class="banner">The DGD Driver</td>
        </tr>
      </table></td>
  </tr>
  <tr>
    <td valign="top">
      <table width="25%"  border="0" cellspacing="1"
             cellpadding="0"  class="main">
        <tr>
          <td class="content" style="font-size: 120%">

          <ul style="margin: 0; padding-left: 10%">
            <li> <a href="index.html">DGD &amp; LPC Page</a> </li>
	    <li> <a href="../LPC">LPC Textbook</a> </li>
	    <li> <a href="../Book">New LPC Introduction</a> </li>
          </ul>

        </td>
        </tr>
        <tr>
          <td class="content" align="center">
            <a href="http://validator.w3.org/check/referer">
            <img src="../../images/valid-xhtml10.gif" alt="Valid XHTML 1.0!"
             style="border:0;width:88px;height:31px" /></a><br />
            <img src="../../images/pixel.gif"
             style="border:0;width:88px;height:1px" alt="" /><br />
            <a href="http://jigsaw.w3.org/css-validator/check/referer">
            <img src="http://jigsaw.w3.org/css-validator/images/vcss"
             alt="Valid CSS!" style="border:0;width:88px;height:31px" />
            </a><br /><br /><br />
            <a href="http://sourceforge.net">
            <img src="http://sourceforge.net/sflogo.php?group_id=48659&amp;type=2"
             style="border: 0; width: 125; height: 37;"
	     alt="SourceForge.net Logo" /></a>
          </td>
        </tr>
      </table></td>
    <td> <table width="100%"  border="0" cellspacing="1" cellpadding="0" 
          class="main">
        <tr>
          <td class="heading">&nbsp;&nbsp;&middot;&nbsp;
	    <a href="http://phantasmal.sf.net/DGD">DGD Page</a> &gt;
            <a href="">State Dumps</a>
          </td>
        </tr>
        <tr>
          <td class="content">
  

  <h2> DGD's State Dumps </h2>

  <p>
    Statedumps provide a way to dump DGD's memory space to disk, much
    as the swapfile does, and restore it at a later time.  All program
    state is maintained.  Pointers continue to work, call_out()
    statements are still scheduled, objects that are previously
    un-upgraded remain that way until recompiled in the standard DGD
    way.  The only difference after a statedump is that network
    connections are broken (of course), and that you can alter the
    code of the DGD server, perhaps by upgrading versions or changing
    the configuration file.  Statedumps are almost invariably forward
    compatible to new stable DGD versions, and there are several other
    upgrades you can make, such as increasing the maximum number of
    objects, which will be transparently caught and permitted with an
    old statedump file.
  </p>

  <p>
    A statedump makes the old save_object() and restore_object()
    functions redundant for saving your MUD's state as a whole, though
    they can occasionally be useful for saving an individual object or
    three.  Like with save_object(), the resulting statedump file can
    contain security-sensitive information, so it should ideally be
    stored where only highly-privileged code can read it.
  </p>

  <p>
    Statedumps are a highly-necessary part of <a
    href="Persistence.html">persistence</a> in a MUD Library.
  </p>

  <p>
    Statedumps, like shutdowns and object recompilation, take place
    immediately after the thread that requested them has ended.  The
    thread that would otherwise immediately follow will occur, but not
    until after the server has been restarted with the just-saved
    statedump.
  </p>

  <p>
    Statedumps are able to handle DGD's normal policy of having far
    more LPC data than available memory.  Normally, a statedump will
    be made incrementally and you can simply tell DGD when to put the
    finishing touches on it, declare it done, and begin writing out
    (what will be) the next incremental statedump.  By telling DGD
    approximately how often you'll be dumping state, you make it much
    easier for the server to write the statedump in a timely way when
    you request it &mdash; nearly all the work has been done in
    advance.
  </p>

  <p>
    Statedumps are, generally speaking, the fastest way to do backups
    in DGD.  Therefore, you should use them regularly to do so, just
    in case.
  </p>

  <h3> Restoring </h3>

  <p>
    When you restore from a statedump, all your previous objects are
    exactly where they were.  However, your network connections, if
    any, have been closed.  You should destruct them if it's necessary
    to do so explicitly.  See the Kernel Library's code for details, or
    use the Kernel Library to make even that part of restoration fully
    transparent.
  </p>

  <h3> Cleanup </h3>

  <p>
    A certain amount of object fragmentation is removed and other
    cleanup tasks done when objects are swapped out.  For that reason,
    it's often good to make sure that DGD is permitted to do at least
    some <a href="Swapping.html">swapping</a>.
  </p>

  <p style="text-size: 150%"> <a href="../index.html"> Back to top level
    </a> </p>
            <address>
            <span><a href="mailto:angelbob-remove-spamfree@spamfree.users.sf.net">Noah Gibbs</a></span>
            </address></td>
        </tr>
      </table></td>
  </tr>
</table>
</body>
</html>
