  <titledef text="Object Database" />

  <h2> Using an Object Database </h2>

  <p>
    A question that appears frequently on the MUD-Dev list and
    occasionally on the DGD list is whether it would be a good idea to
    use an external database to store MUD objects and have DGD access
    that database rather than storing the objects itself.
  </p>

  <p>
    Using a standard database (say MySQL or PostgreSQL) has some
    significant problems.  There's a reason that DGD doesn't normally
    do callout to other languages &mdash; DGD has features like
    rlimits() and atomic functions that are very difficult to
    implement cross-language.  To use an external database, you'd need
    to create a module for DGD to handle these constructs and handle
    interruptions gracefully.  That's not impossible, but it's quite
    difficult.  You could declare that rlimits() and atomic functions
    don't work correctly for database operations.  But you'll find
    that storing all your MUD's objects in a database will thus make
    those features entirely useless.
  </p>

  <p>
    Similarly, DGD's other large, unique feature &mdash;
    upgrade-in-place &mdash; will present difficulties.  Any change in
    the object's data fields will need to update the database fields
    as well, which will be a significant undertaking.  It's quite
    possible to do so, but it's another reason that DGD is simply a
    poor fit for the idea of storing objects in an external database.
    The fact that DGD already stores them so well and so quickly means
    that the possible benefit of using an external database is much
    smaller as well.  In general, DGD is simply poorly suited to the
    use of an external database.
  </p>

  <h3> Internal Databases </h3>

  <p>
    Well, what about a database written in LPC?  You could have an
    object that redirects all calls to get descriptions or other
    textual data to a large database daemon.  Would this cut down on
    memory and increase on processor use?
  </p>

  <p>
    Hard to answer.  Some considerations:
  </p>

  <p>
    Strings are shared within objects.  Constructed strings (such as
    the results of string addition or taking a substring) are not
    shared with identical strings created in a different manner until
    the object is swapped out.
  </p>

  <p>
    putting many shared strings in a single object creates a huge
    object that would have to be in memory all the time, quite
    possibly &lt;increasing&gt; memory use though decreasing swap file
    size.
  </p>

<pre>
Date: Fri, 6 Jul 2001 01:55:00 +0200 (CEST)
From: "Felix A. Croes" <felix@dworkin.nl>
Message-Id: <200107052355.BAA00502@dworkin.nl>
To: dgd@list.imaginary.com
Subject: RE: [DGD]Object properties from an extension

"Michael J. Bacon" <mj.bacon@gte.net> wrote:

> 	Ok, perhaps I am rubbing at this the wrong way.
>
> 	Lets say someone is crazy enough to try to implement persistence outside of
> DGD's statedump type persistence.  Say, we wanted to store and retreive
> object data from an OODBMS.
>
> 	Where would be the best place to hook into that?  Since I can't grab an
> object's data in a generic way, I am assuming I would instead have to define
> some routines on the auto object for registering object data that needs to
> be saved and restored?

I am going to give an answer depressingly similar to the one I gave before:
it's not possible yet, but it will be possible through an official API
at some time in the future.

I intend to make it possible to store mud state in a regular database
instead of a swapfile/dumpfile.  But I'm not going to define that interface
until after multi-processing support, sorry.


> 	Has anyone done anything like this?  I know that LPMOO redefines the
> statedump mechanism to include saving/restoring MOO data to and from a MOO
> database.  Could I use similar techiques?

Doable but very painful.  You would not be able to trust ordinary LPC
code anymore that might not save itself properly.

Regards,
Dworkin
</pre>

  <p style="text-size: 150%"> <a href="../index.html"> Back to top level
    </a> </p>
