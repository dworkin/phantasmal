<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>DGD and LPC: Managing Servers</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="../../phantasmal.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table width="95%" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <td colspan="2"> <table width="100%" border="0" cellspacing="1"
        cellpadding="0" class="main">
        <tr>
          <td class="banner">The DGD Driver</td>
        </tr>
      </table></td>
  </tr>
  <tr>
    <td valign="top">
      <table width="25%"  border="0" cellspacing="1"
             cellpadding="0"  class="main">
        <tr>
          <td class="content" style="font-size: 120%">

          <ul style="margin: 0; padding-left: 10%">
            <li> <a href="index.html">DGD &amp; LPC Page</a> </li>
	    <li> <a href="../LPC">LPC Textbook</a> </li>
	    <li> <a href="../Book">New LPC Introduction</a> </li>
          </ul>

        </td>
        </tr>
        <tr>
          <td class="content" align="center">
            <a href="http://validator.w3.org/check/referer">
            <img src="../../images/valid-xhtml10.gif" alt="Valid XHTML 1.0!"
             style="border:0;width:88px;height:31px" /></a><br />
            <img src="../../images/pixel.gif"
             style="border:0;width:88px;height:1px" alt="" /><br />
            <a href="http://jigsaw.w3.org/css-validator/check/referer">
            <img src="http://jigsaw.w3.org/css-validator/images/vcss"
             alt="Valid CSS!" style="border:0;width:88px;height:31px" />
            </a><br /><br /><br />
            <a href="http://sourceforge.net">
            <img src="http://sourceforge.net/sflogo.php?group_id=48659&amp;type=2"
             style="border: 0; width: 125; height: 37;"
	     alt="SourceForge.net Logo" /></a>
          </td>
        </tr>
      </table></td>
    <td> <table width="100%"  border="0" cellspacing="1" cellpadding="0" 
          class="main">
        <tr>
          <td class="heading">&nbsp;&nbsp;&middot;&nbsp;
	    <a href="http://phantasmal.sf.net/DGD">DGD Page</a> &gt;
	    <a href="http://phantasmal.sf.net/DGD/Running">Running</a> &gt;
            <a href="">Managing Servers</a>
          </td>
        </tr>
        <tr>
          <td class="content">
  

  <h1> Managing Your Server Processes </h1>

<pre>
From: dgd at list.imaginary.com (Alex Swavely)
Date: Thu Apr  3 16:03:00 2003
Subject: [DGD] Running a DGD mud on Linux

On Thu, 3 Apr 2003, Jay Shaffstall wrote:

> I'm about ready to start a 24/7 beta test of my DGD mudlib, and have found
> a Linux machine to run it on.  This is, however, my first time at running a
> mud under Linux.  Can anyone suggest any places to look for more
> information on what all needs to be done?  I'm imagining I'll need to run a
> process periodically to check on the health of the mud server, but that's
> about as far as my imaginings go.

Gurba uses a keepalive script that periodically (run from cron) looks for
a listener on the port you specify, and if not found, runs the startup
script.

Since permission was given in the file for it to be redistributed freely,
I've included it below.

-----

#!/bin/bash
# A bash script to keep the mud up by looking at ps and seeing if
# the driver or startmud script is going, and if it isn't, then
# it invokes that command.  This is meant to be called from your
# machines cron system, so you should add an entry to your crontab
# 0,30 * * * * ~/bin/keepup
# which will check every 30 minutes to see if your mud is still up.
# grep is probably not the best way to check, a regexp is probably
# better, but I figure your executable name should be long and fairly
# unique if you invoke with the full path name, and I'd prefer this to be
# easily portable between shells, and rexexp syntax differs between
# shells.

#Redistribute freely, as usual

#
# Modify these as necessary
#
dgddir=/home/cohort/gurba
port=3000

#######
netstat="netstat -a -t -n"
searchfor="$port.*LISTEN"
startmud=$dgddir/startmud

isup=$($netstat | grep $searchfor)

if [ ${#isup} -eq 0 ]; then
  $startmud &
fi
</pre>

<hr />

<pre>
From: dgd at list.imaginary.com (Noah Lee Gibbs)
Date: Thu Apr  3 17:04:00 2003
Subject: [DGD] Running a DGD mud on Linux

On Thu, 3 Apr 2003, Alex Swavely wrote:
> Gurba uses a keepalive script that periodically (run from cron) looks for
> a listener on the port you specify, and if not found, runs the startup
> script.

  One thing to be careful of here -- you might want to check "ps" for a 
known process number as well.  Otherwise if a MUD hangs but doesn't die 
(and won't accept connections) you'll run DGD every time cron checks, and 
DGD will promptly tell you it can't use that port because somebody else 
already is.
  So having a process number, checking to see if it's still there, and 
(possibly) deciding to kill it if you can't connect after awhile seems 
like a good thing.
  Especially since (IME) DGD and your MUDLib are much more likely to get 
into an unusable state than to outright crash and stop.

-- 
See my page of DGD documentation at
"http://phantasmal.sourceforge.net/DGD/"
If you post to the DGD list, you may see yourself there!
</pre>

  <p style="text-size: 150%"> <a href="../index.html"> Back to top level
    </a> </p>
            <address>
            <span><a href="mailto:angelbob-remove-spamfree@spamfree.users.sf.net">Noah Gibbs</a></span>
            </address></td>
        </tr>
      </table></td>
  </tr>
</table>
</body>
</html>
