<h2><a name="SEC3.2" href="index.html#SEC3.2" id="SEC3.2">3.2 Basic
LPC</a></h2>

<p>LPC is similar to the language C, although some differences
exist. Experienced coders will find it is basically a simplified C
with some new convenient types and new functions. Some
inconsistancies exist but, as with C, they're not a problem if
you're aware of them.</p>

<h3><a name="SEC3.2.1" href="index.html#SEC3.2.1" id=
"SEC3.2.1">Comments</a></h3>

<p>Comments may seem like an odd thing to start with, but they're
everywhere so you need to be able to recognize them from the very
start. They're also important, so you need to know how to write
them from the very start.</p>

<p>In some LPC dialects, there are two kinds of comments:</p>
<pre>
&lt;code&gt; // This is a comment stretching to the end of the line.
       // NOT SUPPORTED BY DGD!

&lt;code&gt; /* This is an enclosed comment */ &lt;more code&gt;
    
</pre>The first type of comment starts off with the <code>//</code>
characters and then stretches all the way to the end of the line.
If you want more lines of comments, you'll have to start off those
as well with new <code>//</code> characters. This is like C++
single-line comments, and DGD does <i>not</i> support them!

<p>The second type has a definite length. Those comments start with
<code>/*</code> and end with <code>*/</code>. They are useful when
you have to write something that will stretch over several lines.
You only have to write the comment symbol at then beginning and
end, and not for every line in between. These are just like
standard C comments.</p>

<p>Please note that the <code>/* */</code> comment can <i>not</i>
be nested. It is <i>not</i> correct to write something like
this:</p>
<pre>
/* A comment
   /* A nested comment */
   the first continues
 */
    
</pre>What will happen is that the comment will end with the first
<code>*/</code> found, leaving the text <code>the first continues
*/</code> to be interpreted as if it was LPC code. That's not valid
LPC code, so instead you'll get an error.

<h3><a name="SEC3.2.2" href="index.html#SEC3.2.2" id=
"SEC3.2.2">Data Types</a></h3>

<p>An object holds information in <b>variables</b>. Variables are a
sort of virtual container that holds information. It's called a
variable because the information is allowed to change later. Most
objects process information with <b>functions</b>. Functions can
use and return data of various kinds.</p>

<p>In principle only one kind of data type is needed, a sort of
general container that would hold anything you wanted it to. LPC
calls this type 'mixed'. Usually, though, it's much more useful if
you can distinguish between different types of information. Knowing
what's in a variable can be a very good thing. It <i>greatly</i>
improves on the time it takes to write and debug an object.</p>

<p>In LPC it is possible to use only data of type 'mixed'. In the
first versions of the language, that was the only data type
available. With modern LPC, however, it's better to avoid mixed
variables when you can.</p>

<p>LPC lets you declare variables of these types:</p>

<dl compact>
  <dt><tt>void</tt></dt>

  <dd>Void is only used as the return type of functions that don't
  return any data at all. You'll never declare a variable of type
  void, though you'll use it like other types.</dd>

  <dt><tt>int</tt></dt>

  <dd>Integers (LPC calls them 'int' for short) are whole numbers,
  normally between -2147483648 and 2147483647. For instance 3, 17,
  -32, and 999 are all perfectly good integers. You can write
  integers in a couple of different ways, such as in hexadecimal
  (base 16), but they're still the same data type underneath,
  they're just written differently.</dd>

  <dt><tt>float</tt></dt>

  <dd>
    <p>Fractional numbers, usually approximately between
    1.17549435e-38 and 3.40282347e+38. For instance 1.3, -348.4,
    2.0 and 4.53e+4 are floating-point numbers (LPC calls them
    'float'). In case you're not familiar with Scientific Notation
    for numbers, 4.53e+4 is the same as 4.53 x 10^4, 4.53 * 10000,
    or 45300.</p>

    <p>LPC doesn't recognized numbers like <code>1.</code> or
    <code>.4711</code> as floats. You have to specify both an
    integer and a decimal part for every number, even if they're
    zero for the number you're typing. LPC's just funny that
    way.</p>
  </dd>

  <dt><tt>string</tt></dt>

  <dd>Strings are simply a series of printable characters. They're
  written with the characters in double quotes. For instance "x",
  "the string", "Another long string with the number 5 in it".
  Strings can contain special characters like newline (written as
  "\n") to end a line. A lot of LPC operators can handle strings
  directly, unlike in C. For instance, you can put two of them
  together with <code>+</code>. This makes strings much easier to
  use.</dd>

  <dt><tt>mapping</tt></dt>

  <dd>Mappings are another handy LPC feature. A mapping is simply a
  list of associated values. Assume you want to remember the ages
  of people. Say that Olle is 23, Peter is 54 and Anna is 15. In
  LPC you can turn this into the mapping <code>([ "Olle":23,
  "Peter":54, "Anna":15 ])</code>. The value to the right has been
  associated to the key to the left. You can then find the value by
  looking for the key. DGD lets you do intersections and unions and
  other operations on mappings.</dd>

  <dt><tt>object</tt></dt>

  <dd>Object pointers are references to LPC programs that have been
  loaded into memory. The object pointer may point to an original
  object, or to a clone.</dd>

  <dt><tt>Array</tt></dt>

  <dd>All of the above can appear in arrays, indicated by a
  <code>*</code> in front of the variable name in the declaration.
  Arrays in LPC are more like lists than arrays in C. LPC and DGD
  let you do unions and intersections and other array operations
  that most languages don't.</dd>

  <dt><tt>mixed</tt></dt>

  <dd>Type mixed is a general descriptor covering all the others, a
  sort of jack-of-all-trades type. An object of any other type may
  be stored within a mixed type. But when a regular type can be
  used, it should. Don't use mixed just because you don't want to
  remember the type's name. The type system is there to catch
  errors for you. Let it.</dd>
</dl>

<p>There's also a special value called <code>nil</code>, which is
not really any of the types above. A string, mapping, array or
mixed variable that isn't initialized has a value of nil. A
freshly-allocated array is often allocated to nil. You can do some
tricks like assigning nil to an entry in a mapping to remove it.
Nil is like an undefined value, or a zero for things that aren't
necessarily numbers. You'll see more of it in examples later
on.</p>

<p>If you need to know the limits of integers, characters or
floating-point numbers, you can check DGD's
<tt>include/limits.h</tt> and <tt>include/float.h</tt> files. They
list limits of the various data types. Bear in mind that DGD can
easily be compiled with different integer and floating point
limits, so it's good to make your code check the sizes. They may be
different next time your program runs!</p>

<h3><a name="SEC3.2.3" href="index.html#SEC3.2.3" id=
"SEC3.2.3">Variable declarations</a></h3>

<p>A variable is a string of letters identifying an information
container, a place to store data. The container is given a name
consisting of 32 characters or less, starting with a letter. No
special character other than the '_' used to separate words is ever
used. Variables should always be given names that reflect how they
are used. You declare variables like this:</p>
<pre>
&lt;data type&gt; &lt;variable name&gt;, &lt;another variable&gt;, ..., &lt;last variable&gt;;
e.g.
    int        counter;
    float      height, weight;
    mapping    age_map;
    
</pre>

<p>Variables must be declared at the beginning of a block,
immediately after the first <code>{</code> and before any other
statements. Global variables, variables that are available in all
functions througout the program, should be declared at the top of
the file.</p>

<p>Variables are initially set to 0 or to nil, and not necessarily
to the obvious 'empty' values. Mappings, arrays and strings will
all be set to nil and not to <code>([])</code>, <code>({})</code>
or <code>""</code> as you might expect.</p>

<p>Arrays and mappings should be initalized to their empty values
(<code>({})</code> and <code>([])</code> respectively) before being
used. You can't add a value to a mapping that's set to nil, for
instance, and you'll get a runtime error if you try.</p>

<h3><a name="SEC3.2.4" href="index.html#SEC3.2.4" id=
"SEC3.2.4">Function declarations</a></h3>

<p>A function's declaration must state what kind of data type it
returns, if any. A function name is a label much like a variable
name, consisting of 32 characters or less and starting with a
letter. No special characters other than <code>_</code> should be
used to separate words. Use function names that clearly reflect on
what they do. A function declaration looks like this:</p>
<pre>
/*
 * Function name: &lt;Function name&gt;
 * Description:   &lt;What it does &gt;
 * Arguments:     <a list="" of="" the="" arguments="" and="" what=
"" they="" contain="">
 * Returns:       &lt;What the function returns&gt;
 */
&lt;return type&gt;
&lt;function name&gt;(&lt;argument list&gt;)
{
   &lt;code expressions&gt;
}
    </a>
</pre><a list="" of="" the="" arguments="" and="" what="" they=""
contain="">The beginning comment, while optional, is highly
recommended. Even if you don't use precisely this form of comment,
you should state what the function does and what it expects to be
given as input. Here is an example function:</a>
<pre>
/*
 * Function name: compute_diam
 * Description:   Compute the diameter of a circle given the 
 *                circumference.
 * Variables:     circumference - the circle's circumference
 *                pi - a famous irrational constant
 * Returns:       The circle's diameter
 */
float compute_diam(float circumference, float pi)
{
    float rval;

    /* Circumference = pi * diameter, so
       diameter = circumference / pi */

    rval = circumference / pi;

    return rval;
}
</pre>

<p>The argument list is a comma-separated list of data types. It
specifies what kinds of data will be sent to the function and
assigns names to this data for later use. The data recieved will
<i>only</i> be usable inside the function, unless you explicitly
send it elsewhere. The function's argument names are valid only
within that function itself.</p>

<p>(In order to save space and improve on legibility in the text, I
won't put a header on every example function).</p>

<p>A function that doesn't return anything should be declared as
<code>void</code>. For instance:</p>
<pre>
void write_stuff(string mess)
{
    write_file("/usr/Bob/myfile.txt", mess);
}
    
</pre>

<h3><a name="SEC3.2.5" href="index.html#SEC3.2.5" id=
"SEC3.2.5">Statements and Expressions</a></h3>

<p>We need to define what a <b>statement</b> and what an
<b>expression</b> are in order to proceed.</p>

<h4><a name="SEC3.2.5.1" href="index.html#SEC3.2.5.1" id=
"SEC3.2.5.1">Statements</a></h4>

<p><a name="IDX10" id="IDX10"></a> <a name="IDX11" id="IDX11"></a>
A statement is sort of a full sentence of instructions, made up
from one or more expressions. Statements usually cover no more than
a single line of code. Sometimes it's necessary to break it up
though if it becomes too long simply to improve on legibility -- a
little like avoiding long run-on sentences. For most statements you
simply break the line between two words, but if you are in the
middle of a string you need to add a backslash (<code>\</code>) at
the end of the line in order for the gamedriver to understand
what's going on.</p>
<pre>
DRIVER-&gt;message("This is an example of \
a broken string.\n");
    
</pre>

<p>However, breaking a statement with backslash is extremely ugly
and makes the code hard to read. It's usually possible to break the
line naturally at the end of a string, or between two operators of
some kind, or even just split the string in half and add the two
parts together with the <code>+</code> operator. The only time the
backslash really is necessary is in
<code>#define</code>-statements, which we'll mention later.</p>
<pre>
DRIVER-&gt;message("This is a better way of " +
                "breaking a string.\n");
</pre>

<p>Statements in LPC almost always end with <code>;</code>. It's
considered good practice to put a newline there as well. That is to
say, you shouldn't put multiple statements on the same line if you
can help it. Keeping them separate makes them easier to read.</p>

<h4><a name="SEC3.2.5.2" href="index.html#SEC3.2.5.2" id=
"SEC3.2.5.2">Expressions</a></h4>

<p>An expression is an instruction or set of instructions that
results in a value. A variable is an expression since it yields its
contents as a result. <code>a + b</code> is a valid expression,
because <code>a</code> and <code>b</code> are variables
(expressions) and <code>+</code> is an operator that takes two
expressions to make another expression. <code>a = b + c;</code> is
a full statement ending in a <code>;</code>. Because the
<code>=</code> operator returns a value, <code>a = b + c</code> is
an expression, but when you add a <code>;</code>, it becomes a
statement. It's like when you add a period to the end of a bunch of
words and suddenly you have a sentence.</p>

<p>Function calls are valid expressions. They are written simply as
the name followed by a set of parentheses with the arguments that
the functions uses listed inside. Take the simple function
<code>max()</code> for example, that returns the maximum of the two
floating-point arguments. To determine the maximum of
<code>4.0</code> and <code>10.0</code>, you would write
<code>max(4.0, 10.0)</code> as the expression. The result of the
function call must be stored or used in an expression, or it is
lost. That's fine if you're calling the function because of some
other effect it has, such as <code>write_file()</code>.</p>

<h4><a name="SEC3.2.5.3" href="index.html#SEC3.2.5.3" id=
"SEC3.2.5.3">The block statement</a></h4>

<p><a name="IDX12" id="IDX12"></a> There are a lot of statements
such as conditional statements that in certain circumstances
execute only <i>one</i> specified statement and no more. Suppose
you want to have several statements executed and not just one?
Well, there's a special statement called <b>block</b> statement
that will allow you to do that. A block is defined as starting with
a <code>{</code> and ending with a <code>}</code>. Within that
block you may have as many statements of any kind (including
variable definitions) as you like. The block statement shouldn't
end with a <code>;</code>, though usually it doesn't matter if you
accidentally put one there. Example:</p>
<pre>
if(my_var &lt; 3)
{
  statement_one();
  statement_two();
  statement_three();
}
    
</pre>

<h4><a name="SEC3.2.5.4" href="index.html#SEC3.2.5.4" id=
"SEC3.2.5.4">The ';' statement</a></h4>

<p>As stated <code>;</code> is mostly used to terminate statements.
However it's also a statement in its own right.</p>

<p>The <code>;</code> on it's own will simply be a null statement
causing nothing to happen. This is useful when you have
test-clauses and loops (described later) that perform their
intended purpose within the test or loop clause and aren't actually
intended to do anything else. Just remember that anywhere you're
allowed to have a statement, you can just put a <code>;</code> as a
statement that does nothing.</p>
