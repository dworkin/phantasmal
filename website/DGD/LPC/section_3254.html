<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title> DGD LPC Textbook </title>
  </head>

  <body text="#000000" bgcolor="#DDDDDD" link="#0000EF" vlink="#51188E"
	alink="#FF0000">

    <h1> LPC:  The LPMUD Programming Language </h1>
    <h2> DGD edition </h2>

    <p> Copyright 1996, 2003 Ronny Wikh and Noah Gibbs </p>

    <hr size="2">

    <h2><a name="SEC3.2" href="index.html#SEC3.2">Basic LPC</a></h2>

    <p>
      LPC is similar to the language C, although some differences
      exist.  Experienced coders will find it is basically a
      simplified C with some new convenient types and new functions.
      Some inconsistancies exist but, as with C, they're not a problem
      if you're aware of them.
    </p>


    <h3><a name="SEC3.2.1" href="index.html#SEC3.2.1">Comments</a></h3>

    <p>
      Comments may seem like an odd thing to start with, but they're
      everywhere so you need to be able to recognize them from the
      very start.  They're also important, so you need to know how to
      write them from the very start.
    </p>

    <p>
      In some LPC dialects, there are two kinds of comments:

    <pre>
&lt;code&gt; // This is a comment stretching to the end of the line.

&lt;code&gt; /* This is an enclosed comment */ &lt;code&gt;
    </pre>

    The first type of comment starts off with the <code>//</code>
    characters and then stretches all the way to the end of the line.
    If you want more lines of comments, you'll have to start off those
    as well with new <code>//</code> characters.  This is like
    C++ single-line comments, and DGD does <i>not</i> support them!
  </p>

    <p>
      The second type has a definite length.  Those comments start
      with <code>/*</code> and end with <code>*/</code>. They are
      useful when you have to write something that will stretch over
      several lines.  You only have to write the comment symbol at
      then beginning and end, and not for every line in between.
      These are just like standard C comments.
    </p>

    <p>
      Please note that the <code>/* */</code> comment can <i>not</i>
      be nested.  It is <i>not</i> correct to write something like
      this:

    <pre>
/* A comment
   /* A nested comment */
   the first continues
 */
    </pre>

    What will happen is that the comment will end with the first
    <code>*/</code> found, leaving the text <code>the first continues
    */</code> to be interpreted as if it was LPC code.  That's not
    valid LPC code, so instead you'll get an error.
  </p>


    <h3><a name="SEC3.2.2" href="index.html#SEC3.2.2">Data types</a></h3>

    <p>
      The object holds information in <b>variables</b>. As the name
      hints these are data containers that hold information that may
      vary from time to time.  The object processes information in
      <b>functions</b> that both use and return data of various kinds.
    </p>

    <p>
      In principle only one kind of data type is needed, a sort of
      general container that would cover anything you wanted to do.
      LPC calls this type 'mixed'.  Usually, it's much more useful if
      you can distinguish between different types of information.
      This might seem only to add to the complexity of your
      programming, but in fact it reduces the risk of faulty code and
      improves legibility. It <i>greatly</i> improves on the time it
      takes to write and debug an object.
    </p>

    <p>
      In LPC it is possible to use only data of type 'mixed'. In the
      first versions of the language it was the only data type
      available.  With modern LPC, however, it is preferable to avoid
      mixed variables wherever you can.
    </p>

    <p>
      The following types of data are defined:

    <dl compact>
      <dt><tt>void</tt>
      <dd>
	<a name="IDX1"></a>
	<tt>Nothing</tt> 

	This data type is used exclusively for functions that
	don't return any data at all.

      <dt><tt>int</tt>
      <dd>
	<a name="IDX2"></a>
	<tt>Integers</tt> 

	Whole numbers in the range -2147483648 to 2147483647.  e.g. <code>3, 17,
	  -32, 999</code>.

      <dt><tt>float</tt>
      <dd>
	<a name="IDX3"></a>
	<tt>Floating point numbers</tt> 

	Decimal numbers of any kind in the approximate range 1.17549435e-38 to
	3.40282347e+38. e.g. <code>1.3, -348.4, 4.53e+4</code>. The range values are
	approximate since this might vary from mud to mud as it's platform
	dependant.

	If there are any FORTRAN fossiles around there, beware that numbers like
	<code>1.</code> or <code>.4711</code> are <i>not</i> recognized as floats, you have
	to specify both an integer and a decimal part, even if they only are 0.

      <dt><tt>string</tt>
      <dd>
	<a name="IDX4"></a>
	<tt>`Character strings'</tt> 

	Strings are simply a series of printable characters within quotes,
	e.g. <code>"x", "the string", "Another long string with the number 5 in
	  it"</code>. Strings can contain special characters like newline (<code>"\n"</code>)
	to end a line. A lot of LPC expressions can handle strings directly,
	unlike usual C. This makes strings very handy and easy to use.

      <dt><tt>`mapping'</tt>
      <dd>
	<a name="IDX5"></a>
	<tt>`Associated list'</tt>

	Mappings are another handy LPC invention (memory expensive, use with
	care!). A mapping is simply a list of associated values. Assume you want
	to remember the ages of people, like Olle is 23, Peter is 54 and Anna is
	15. In LPC you can write this as <code>([ "Olle":23, "Peter":54,
	  "Anna":15 ])</code>. As you can see the value to the right has been associated
	to the value to the left. You can then extract the associated value
	through a simple indexing operation using the left hand value as index.

      <dt><tt>`object'</tt>
      <dd>
	<a name="IDX6"></a>
	<tt>`Object pointer'</tt>

	They are references to LPC programs that has been loaded into memory.

      <dt><tt>`Array'</tt>
      <dd>
	<a name="IDX8"></a>
	All of the above can appear in arrays, indicated by a <code>*</code> in front of
	the variable name in the declaration.

	Arrays in LPC are more like lists than proper arrays. A number of functions
	and operator facilites exist to make them easy and quick to use.

      <dt><tt>`mixed'</tt>
      <dd>
	<a name="IDX9"></a>
	This, finally, is a general descriptor covering all the other, a sort of
	jack-of-all-trades type. Again, let me stress the fact that using it
	except when <i>absolutely</i> necessary only provokes mistakes.

	Hm, as pointed out to me this might sound a bit too strict. The mixed
	type is used for good reasons fairly often. What I mean is that when
	a regular type can be used, it should. Don't substitute it for mixed just
	because you feel lazy.

</DL>



<h3><a name="SEC3.2.3" href="index.html#SEC3.2.3">Variable declarations</a></h3>

<p>
A variable is a string of letters identifying an information 'box', a place
to store data. The box is given a name consisting of &lt; 32 characers,
starting with an alphabetic letter. Custom and common sense dictate that
all variables used inside a function consist of lowercase letters
only. Global variables have the first letter in uppercase, the rest
lowercase. No special character other than the '_' used to separate words
is ever used. Variables should <i>always</i> be given names that reflect
on their use. You declare variables like this:

</p>

<pre>
&lt;data type&gt; &lt;variable name&gt;, &lt;another variable&gt;, ..., &lt;last variable&gt;;
e.g.
    int        counter;
    float      height, weight;
    mapping    age_map;
</pre>

<p>
Variables must be declared at the beginning of a block (right after the
first '{') and before any code statements. Global variables, variables that
are available in all functions througout the program, should be declared at
the top of the file.

</p>
<p>
When the declarations are executed as the program runs, they are initially
set to 0, <b>NOT</b> to their 'null-state' values. In other words for
example mappings, arrays and strings will all be set to 0 and not to
<code>([])</code>, <code>({})</code> and <code>""</code> as you might believe. It is possible
to initialize variables in the declaration statement, and it's even a very
good habit always to initialize arrays and mappings there:

</p>

<pre>
&lt;data type&gt; &lt;variable name&gt; = &lt;value&gt;, etc.
e.g.
    int        counter = 8;
    float      height = 3.0, weight = 1.2;
    mapping    age_map = ([]);
    object     *monsters = ({});
</pre>

<p>
The reason why arrays and mappings should be initalized in the
declaration statement to their 'NULL' values (<code>({})</code> and
<code>([])</code> respectively) is that otherwise they are initialized to 0,
which is incompatible with the proper type of the variable and might
cause problems later.

</p>


<h3><a name="SEC3.2.4" href="index.html#SEC3.2.4">Function declarations</a></h3>

<p>
A function must give proper notification of what kind of data type it
returns, if any. A function is a label much like a variable name,
consisting of &lt; 32 characters, starting with a letter. Custom
and common sense dictate that all function names should be lowercase and
only contain the special character '_' to separate words. Use function
names that clearly reflect on what they do. A function declaration looks
like this:

</p>

<pre>
/*
 * Function name: &lt;Function name&gt;
 * Description:   &lt;What it does &gt;
 * Arguments:     <A list of the arguments and what they contain>
 * Returns:       &lt;What the function returns&gt;
 */
&lt;return type&gt;
&lt;function name&gt;(&lt;argument list&gt;)
{
   &lt;code expressions&gt;
}
</pre>


<pre>
/*
 * Function name: compute_diam
 * Description:   Compute the diameter of a circle given the 
 *                circumference.
 * Variables:     surf_area - the surface area
 *                name - the name given the circle
 * Returns:       The circumference.
 */
float
compute_diam(float surf_area, string name)
{
    float rval;
	    
    // Circumference = pie * diameter
    rval = surf_area / 3.141592643;
    write("The diameter of " + name + " is " + ftoa(rval) + "\n");

    return rval;
}
</pre>

<p>
The argument list is a comma-separated list of data types, much like a
variable declaration where you specify what kind of data will be sent to
the function and assign names to this data for later use in the function.
The data recieved will <b>only</b> be usable inside the function, unless you
explicitly send it out through a function call.

</p>
<p>
(In order to save space and improve on legibility in the manual I won't
put a header to all my short example functions).

</p>
<p>
A function that doesn't return anything should be declared as <code>void</code>.

</p>

<pre>
void
write_all(string mess)
{
    users()-&gt;catch_msg(mess);
}
</pre>



<h3><a name="SEC3.2.5" href="index.html#SEC3.2.5">Statements and Expressions</a></h3>

<p>
We need to define what a <b>statement</b> and what an <b>expression</b> is
in order to be able to proceed.

</p>

<ul>
<li><a href="lpc.html#SEC22">Statements</a>: Definition of statements
<li><a href="lpc.html#SEC23">Expressions</a>: Definition of expressions
<li><a href="lpc.html#SEC24">Block statement</a>: The block statement
</ul>



<H4><a name="SEC22" href="index.html#SEC22">Statements</a></H4>
<p>
<a name="IDX10"></a>
<a name="IDX11"></a>

</p>
<p>
A statement is sort of a full sentence of instructions, made up from one
or more expressions. Statements usually cover no more than a single line
of code. Sometimes it's necessary to break it up though if it becomes too
long, simply to improve on legibility. For most statements you simply 
break the line between two words, but if you are in the middle of a 
string you need to add a backslash (<code>\</code>) at the end of the line 
in order for the gamedriver to understand what's going on.

</p>

<pre>
write("This is an example of \
      a broken string.\n");
</pre>

<p>
However, breaking a statement with backslash is extremely ugly and makes
the code hard to read. In fact, it's usually possible to break the line
naturally at the end of a string, between two operators of some kind, or
even just split the string in half and add the two parts together with the
<code>+</code> operator. The only time the backslash really is necessary is in
<code>#define</code>-statements, handled later.

</p>

<pre>
write("This is a better way of " +
      "breaking a string.\n");
</pre>

<p>
Statements in LPC are usually ended with a <code>;</code>, which also is a
good place to end the line. There's nothing stopping you from entering
another statement right after, other than that it will look awful.

</p>


<H4><a name="SEC23" href="index.html#SEC23">Expressions</a></H4>

<p>
An expression is an instruction or set of instructions that results in a
value of some kind. Take <code>+</code>, for example. It uses two other
expressions to make up a result. A variable is an expression since it
yields its contents as a result. The combination of the following two
expressions and an operator is a valid expression: <code>a + b</code>,
<code>a</code> and <code>b</code> being variables (expressions) and <code>+</code> being
the operator used on them. <code>a = b + c;</code> is a full statement ending
in a <code>;</code>.

</p>
<p>
Function calls are valid expressions. They are written simply as the
name followed by a set of matched parentheses with the arguments that
the functions uses listed inside. Take the simple function <code>max()</code> 
for example, that returns the max of the two arguments. To determine the
maximum of <code>4</code> and <code>10</code>, you would write <code>max(4, 10)</code> as
the expression. Naturally the result must be either stored or used.

</p>


<H4><a name="SEC24" href="index.html#SEC24">The block statement</a></H4>
<p>
<a name="IDX12"></a>

</p>
<p>
There are a lot of statements, for example conditional statements, that
in certain circumstances execute <i>one</i> specified statement and
never else. Suppose you want to have several statements executed 
and not just one? Well, there's a special statement called <b>block</b>
statement that will allow you to do that. A block is defined as starting
with a <code>{</code> and ending with a <code>}</code>. Within that block you may
have as many statements of any kind (including variable definitions) as
you like. The block statement is not ending with a <code>;</code>, even though
it doesn't matter if you accidentally put one there.

</p>


<H4><a name="SEC25" href="index.html#SEC25">The ';' statement</a></H4>

<p>
As stated <code>;</code> is mostly used to terminate statements, however it's
also a statement in its own right.

</p>
<p>
The <code>;</code> on it's own will simply be a null-statement causing nothing
to happen. This is useful when you have test-clauses and loops (described
later) that perform their intended purpose within the test or loop clause
and aren't actually intended to do anything else.

</p>


    <hr>
    <a href="http://sourceforge.net">
      <img src="http://sourceforge.net/sflogo.php?group_id=48659&type=6"
	   width="210" height="62" border="0" alt="SourceForge.net Logo"></a>
    <address><a href="mailto:noah_gibbs@yaNOSPAMhoo.com">Noah Gibbs</a>
    </address>
    <!-- Created: Mon Jun 11 21:50:30 PDT 2001 -->
    <!-- hhmts start -->
Last modified: Tue Apr  8 18:49:06 PDT 2003
<!-- hhmts end -->
  </body>
</html>
