<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Adding Stuff to your MUDLib: Directory Structure</title>
  </head>

  <body text="#000000" bgcolor="#DDDDDD" link="#0000EF" vlink="#51188E"
	alink="#FF0000">

    <font size="4">

    <h1> Your MUDLib's Directory Structure </h1>

    <p> Where do I <b>put</b> all this stuff? </p>

    <p> You've probably asked yourself that several times already,
      just getting started.  When you make a new library, or a new
      clonable, or a new data file, where do you <i>put</i> it?  This
      document can get you started. </p>

    <p> Where you put stuff is surprisingly important.  The Kernel
      MUDLib hardcodes a <i>lot</i> of behavior according to paths.
      That includes a lot of information about who has access to what,
      and whether an object is inheritable, clonable or an LWO.  So
      let's hit some basic guidelines. </p>

    <h2> Where do specific object types go? </h2>

    <p> You'll need to put a &quot;/lib/&quot; directory somewhere in
      the path to every library (inheritable).  The Kernel MUDLib
      requires it.  It's good practice.  It's good documentation.  Do
      it. </p>

    <p> If you're using lightweight objects (LWOs), you'll need to do
      the same with a &quot;/data/&quot; directory in the path.  This
      isn't required for the libraries that the LWO object inherits.
      Those use &quot;/lib/&quot; just like any other library. </p>

    <p> There's a strong convention that clonables should have
      &quot;/obj/&quot; in their path in the same way.  You don't have
      to do it for every object with data.  In fact, daemons (below)
      are a common, specific example of an object with data, that you
      can call functions on, that doesn't tend to have &quot;obj&quot;
      in the path.  It's still highly recommend, and for objects you
      actually want to clone, it's required.  Besides, it's good
      documentation for other people looking at your MUDLib. </p>

    <p> Daemons are objects like any others, but they're meant to be
      used by doing a find_object on them and calling their methods
      with call_other.  They may have guards in their create()
      routines that prevent cloning, though that's not usually
      necessary.  It's good documentation, though.  Daemons often wind
      up in a directory with &quot;/sys/&quot; in the name instead of
      &quot;/lib/&quot; or &quot;/obj/&quot;.  This is purely
      optional, mostly a form of documentation.  You're just saying
      that you plan to use objects in that directory as daemons. </p>

    <h2> What about Data? </h2>

    <p> This one's important too, but for different reasons.  The
      Kernel MUDLib doesn't explicitly prevent paths from being opened
      with read_file(), which is the way pretty much any data file is
      accessed.  But different paths require different permissions to
      access.  For instance, stuff in &quot;/usr/System&quot; is
      readable and writable only by the privileged admin user by
      default. </p>

    <p> You may not want to keep the user data there.  While passwords
      are encrypted, you may need to give certain wizards read access
      to System but not want them to be able to read all the
      save files.  If so (or out of sense of following
      conventions) you should probably move it to /save, which is not
      only not world-readable, but has specific guards in the Kernel
      Library for additional security.  It's a great place to put private
      stuff that only very privileged code can access.  It's meant to
      be. </p>

    <h2> What directories does the Kernel Library treat specially? </h2>

    <p> The Kernel Library checks various things about the path in many
    of its operations.  Let's look at different operations, and what
    the Kernel Library checks about the path for each one.
    </p>

    <ul>
      <li> A lot of Kernel MUDLib functions can only be called from
        objects under /usr/System. </li>
      <li> The /kernel and /include/kernel directories are guaranteed
        writable to nobody. </li>
      <li> You can't call_other on any object with /lib in its path.
        </li>
      <li> You can only inherit objects with /lib in their paths.</li>
      <li> Objects with /kernel in the path can only be inherited by
        objects in /usr/System </li>
      <li> Only objects outside the System directory can have a special
        nonstandard AUTO object. </li>
      <li> Files with /include in the path can always be included,
        regardless of read access. (TEST ME, with and without a '..'
	in the path) </li>
      <li> Objects in /kernel have no maximum rlimits(), so they could
        theoretically loop infinitely or crash for lack of stack space.
        In practice, this essentially never happens. </li>
      <li> Objects in /usr/System may voluntarily choose not to limit
        their number of ticks in rlimits().  This means they may occasionally
	loop infinitely, especially if coded poorly. </li>
      <li> Files outside /usr, or in /usr/foo/open (for any value of foo)
        are readable to everybody.  Except stuff in /kernel/data, that's
	not necessarily open to reading. </li>
      <li> A user has full access of every kind to stuff in his own
        directory.  So do objects from that user's directory. </li>
      <li> The default wiztool library won't clone or destruct objects
        from /kernel by default.  That can be overridden, though. </li>
      <li> (Finish checking kernel/lib dir)</li>
    </ul>

    <hr> </hr>

    <h2> Specific Projects </h2>

    <p> This is part of the Adding Stuff section, so what kind of stuff
      should you add?  One simple answer is &quot;everything&quot;, since
      this document tells you where everything goes.  But there are also
      some projects you can undertake to improve your MUDLib. </p>

    <p> For instance, a simple thing you can do is to move your user
      data from its current save location to &quot;/save&quot;, as
      we suggest above.  Mainly you'll need to modify &quot;user.c&quot;.
      Go give it a try! </p>

    <hr> </hr>
      <a href="http://sourceforge.net">
	<img src="http://sourceforge.net/sflogo.php?group_id=48659&type=3"
	     width="125" height="37" border="0" alt="SourceForge.net Logo"></a>
    <address><a href="mailto:angelbob-remove-spamfree@spamfree.monkeyspeak.com">Noah Gibbs</a></address>
    <!-- Created: Mon Jun 11 21:50:30 PDT 2001 -->
    <!-- hhmts start -->
Last modified: Tue Mar 12 23:18:16 PST 2002
<!-- hhmts end -->
  </body>
</html>
