<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Phantasmal Admin Tutorials: Evaluating Arbitrary Code</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="http://phantasmal.sf.net/phantasmal.css"
      rel="stylesheet" type="text/css" />
</head>
<body>
<table width="95%" border="0" cellspacing="0" cellpadding="4">
  <tr>
    <td colspan="2"> <table width="100%" border="0" cellspacing="1"
        cellpadding="0" class="main">
        <tr>
          <td class="banner">Phantasmal Admin Tutorials</td>
        </tr>
      </table></td>
  </tr>
  <tr>
    <td valign="top">
      <table width="25%"  border="0" cellspacing="1"
             cellpadding="0"  class="main">
        <tr>
          <td class="content" style="font-size: 120%">

          <ul style="margin: 0; padding-left: 10%">
            <li> <a href="../../index.html">Phantasmal Main</a> </li>
            <li> <a href="../index.html">Phantasmal Tutorials</a> </li>
	    <li> <a href="http://www.sf.net/projects/phantasmal">Phantasmal
	      SourceForge</a> </li>
            <li> <a href="../../DGD/index.html">DGD &amp; LPC Page</a> </li>
	    <li> <a href="../../DGD/LPC">LPC Textbook</a> </li>
          </ul>

        </td>
        </tr>
        <tr>
          <td class="content" align="center">
            <a href="http://validator.w3.org/check/referer">
            <img src="../../images/valid-xhtml10.gif" alt="Valid XHTML 1.0!"
             style="border:0;width:88px;height:31px" /></a><br />
            <img src="../../images/pixel.gif"
             style="border:0;width:88px;height:1px" alt="" /><br />
            <a href="http://jigsaw.w3.org/css-validator/check/referer">
            <img src="http://jigsaw.w3.org/css-validator/images/vcss"
             alt="Valid CSS!" style="border:0;width:88px;height:31px" />
            </a><br />
            <a href="http://sourceforge.net">
            <img src="http://sourceforge.net/sflogo.php?group_id=48659&amp;type=6"
             style="border: 0; width: 210; height: 62;"
	     alt="SourceForge.net Logo" /></a>
          </td>
        </tr>
      </table></td>
    <td> <table width="100%"  border="0"
          cellspacing="1" cellpadding="0"  class="main">
        <tr>
          <td class="heading">&nbsp;&nbsp;&middot;&nbsp;
	    <a href="../../index.html">Phantasmal</a> &gt;
            <a href="../index.html">Tutorials</a> &gt;
            <a href="index.html">Admin</a> &gt;
            <a href="">Evaluating Arbitrary Code</a>
          </td>
        </tr>
        <tr>
          <td class="content">
    

    <h2 style="text-align: center"> Evaluating Arbitrary Code </h2>

    <p> When you were <a href="Compiling.html">compiling</a> code
      earlier, you may have thought it was a little odd to see a
      result like &quot;$0 = &lt;/usr/System/initd&gt;&quot;.  This
      tutorial will tell you what that means. </p>

    <p> The <b>%history</b> command will show you values like $0 above
      if you type it by itself from the command line.  You should see
      all the results that you got from the <b>%compile</b>, <b>%clone</b>
      and <b>%code</b> commands. </p>

    <p> Clone?  Code?  Those are new ones.  Let's hit <b>%clone</b> first.
      You'll need to pick a clonable object, one that could be useful to
      clone, or at least not going to cause an error.  So daemons like
      InitD are right out.  Instead, try typing &quot;%clone
      /usr/common/obj/simple_portable&quot;.  It should return something
      like &quot;$2 = &lt;/usr/common/obj/simple_portable&gt;&quot;.
      But you don't want something like that hanging around without
      supervision, so go ahead and get rid of it.  Type
      &quot;%destruct $2&quot; -- but use whatever number you got back
      from <b>%clone</b>, don't just destruct history object number 2.
    </p>

    <p> Note that if instead we had typed &quot;%destruct
      /usr/common/obj/simple_portable&quot;, it would <i>not</i> have
      done the same thing -- there are specific, individual clones of
      each cloneable object, and they take some tracking down.  You
      can see how many a given object has by typing
      &quot;%od_report &lt;object&gt;&quot;, though there are some
      subtleties there -- it may not report the full number if you have
      multiple issues of an object that aren't properly upgraded.  If
      this is all greek to you, don't worry about it.  Just take my
      word for it that specific individual clones are tough to track
      down, so make sure to destruct the ones you create.
    </p>

    <p> Now that you've carefully cleaned up after yourself, go ahead
      and type &quot;%clear&quot.  It'll clear out your entire history
      list so far and you'll lose any references to things that you
      were keeping around.  That's why you cleaned up first. </p>

    <p> And that leaves only the <b>%code</b> command to introduce.
      Go ahead and type &quot;%code 4&quot;.  You'll get a result like
      &quot;$17 = 4&quot;.  Exciting, huh?  But you can use the same
      thing to evaluate arbitrary LPC code, and that's much more
      interesting.  For instance, you could type &quot;%code ({ 1, 7,
      9 }) [1]&quot;, which should return the value 7.  Or you can
      cause side-effects by calling objects in Phantasmal.  A pretty
      harmless example is &quot;%code
      find_object("/usr/common/sys/mapd")->get_room_by_num(7)&quot;
      which should find the MAPD and return you a reference to object
      #7, or nil.  Naturally you can also reduce it to &quot;%code
      find_object(&quot;/usr/common/sys/mapd&quot;)&quot; and then use
      the number it returns -- for instance, if it came back with
      &quot;$34 = &lt;/usr/common/sys/mapd&gt;&quot;, you could then
      say &quot;%code $34->get_room_by_num(347)&quot;.
    </p>

    <p> So there are your fun toys of the day.  Knock yourself out.
      And keep reading <a href="../index.html">tutorials</a>! </p>
            <address> 
            <span><a href="mailto:angelbob-remove-spamfree@spamfree.users.sf.net">Noah Gibbs</a></span> 
            </address></td> 
        </tr> 
      </table></td> 
  </tr> 
</table> 
</body>
</html>
